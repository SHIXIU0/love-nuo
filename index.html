<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>ç»™è¯ºè¯ºçš„å¼€å¿ƒç©ºæŠ•</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href='data:application/json,{ "name":"å¼€å¿ƒè¯ºè¯º","short_name":"è¯ºè¯º","start_url":"/","display":"standalone","background_color":"#000","theme_color":"#d11090","icons":[{"src":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI5NiIgY3k9Ijk2IiByPSI5NiIgZmlsbD0iI2QxMTA5MCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LXNpemU9IjEyMCIgZmlsbD0iI2ZmZiIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+8J+YijwvdGV4dD48L3N2Zz4=","sizes":"192x192","type":"image/svg+xml"}]}'>
</head>
<body>
<video id="bg" autoplay muted loop playsinline></video>
<h1 id="wish"></h1>

<audio id="bgm" loop></audio>

<script>
/* ===== 1. éšæœºæ–‡æ¡ˆæ±  ===== */
const wishes = [
  "å¸Œæœ›è¯ºè¯ºå¤©å¤©å¼€å¿ƒï¼",
  "ä»Šå¤©ä¹Ÿè¦æ¯”æ˜¨å¤©æ›´å¿«ä¹å‘€ï½",
  "ä½ ä¸€ç¬‘ï¼Œä¸–ç•Œå°±äº®äº†âœ¨",
  "æŠŠçƒ¦æ¼è°ƒæˆé™éŸ³ğŸ”‡",
  "è¯ºè¯ºçš„è¶…èƒ½åŠ›ï¼šç§’å˜å¼€å¿ƒï¼"
];
document.getElementById('wish').textContent = wishes[Math.floor(Math.random()*wishes.length)];

/* ===== 2. éšæœºèƒŒæ™¯ï¼ˆè§†é¢‘/å›¾ç‰‡åŒä¿é™©ï¼‰ ===== */
const videos = [
  "https://cdn.jsdelivr.net/gh/verlok/doge@main/dynamic/christmas.mp4",
  "https://cdn.jsdelivr.net/gh/verlok/doge@main/dynamic/rainbow.mp4"
];
const imgFallback = "https://source.unsplash.com/1600x900/?rainbow,smile";
const vid = document.getElementById('bg');
vid.src = videos[Math.floor(Math.random()*videos.length)];
vid.onerror = () => {                       // CDN æŒ‚äº†å°±æ¢å›¾ç‰‡
  vid.style.display='none';
  document.body.style.background=`url(${imgFallback}) center/cover no-repeat fixed`;
};

/* ===== 3. éšæœºæ­Œå•ï¼ˆç½‘æ˜“çƒ­é—¨ 5 é¦–ï¼‰ ===== */
const songs = [
  {id:1963443271, name:"æ™´å¤©"},            // åŸæ›²
  {id:1859245775, name:"ç¨»é¦™"},
  {id:1860164833, name:"èŠ±æµ·"},
  {id:1859332214, name:"ä¸ƒé‡Œé¦™"},
  {id:1859332232, name:"å‘Šç™½æ°”çƒ"}
];
const pick = songs[Math.floor(Math.random()*songs.length)];
const bgm = document.getElementById('bgm');
bgm.src = `https://music.163.com/song/media/outer/url?id=${pick.id}.mp3`;
bgm.onerror=()=>{                           // ç½‘æ˜“ 403 å°±æ¢å¤‡ç”¨æº
  bgm.src="https://cdn.jsdelivr.net/gh/verlok/doge@main/mp3/happy.mp3";
};

/* ===== 4. é¦–æ¬¡ç‚¹å‡»æ’­æ”¾ + åç»­è‡ªåŠ¨æ’­æ”¾ ===== */
document.body.addEventListener('click',()=>bgm.play(),{once:true});

/* ===== 5. PWAï¼šå®‰è£…åˆ°æ¡Œé¢ & ç¦»çº¿ ===== */
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>